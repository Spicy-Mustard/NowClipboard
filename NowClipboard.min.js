/**
 * NowClipboard v1.1.3
 * Modern clipboard utility library - Clipboard API + execCommand fallback + Node.js adapter
 * Licensed MIT Â© Spicy-Mustard
 */
!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.NowClipboard=t()}("undefined"!=typeof self?self:this,function(){"use strict";var l="undefined"!=typeof window&&"undefined"!=typeof document,o="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node;function c(e){return"string"==typeof e||e instanceof String}function i(e){return"function"==typeof e}function s(e){return null!=e&&"object"==typeof e&&1===e.nodeType}function u(){return l&&"undefined"!=typeof navigator&&null!=navigator.clipboard&&"function"==typeof navigator.clipboard.writeText}function d(){return l&&"undefined"!=typeof navigator&&null!=navigator.clipboard&&"function"==typeof navigator.clipboard.write&&"function"==typeof ClipboardItem}function r(){this._events={}}function p(e){var t="",r=e.nodeName;if("SELECT"===r)e.focus(),t=e.value;else if("INPUT"===r||"TEXTAREA"===r){r=e.hasAttribute("readonly");r||e.setAttribute("readonly",""),e.select();try{e.setSelectionRange(0,e.value.length)}catch(e){}r||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var r=window.getSelection(),n=document.createRange();n.selectNodeContents(e),r.removeAllRanges(),r.addRange(n),t=r.toString()}return t}function f(){try{var e;window.getSelection&&((e=window.getSelection()).removeAllRanges?e.removeAllRanges():e.empty&&e.empty())}catch(e){}}function m(e){return navigator.clipboard.writeText(e).then(function(){return e})}function n(e,t){o=e,(r=document.createElement("textarea")).style.fontSize="12pt",r.style.border="0",r.style.padding="0",r.style.margin="0",r.style.position="absolute",r.style.opacity="0",n="rtl"===document.documentElement.getAttribute("dir"),r.style[n?"right":"left"]="-9999px",n=window.pageYOffset||document.documentElement.scrollTop,r.style.top=n+"px",r.setAttribute("readonly",""),r.value=o;var r,n=r,o=((t||document.body).appendChild(n),p(n),!1);try{o=document.execCommand("copy")}catch(e){o=!1}return n.remove(),f(),o?x(e):T(new Error("execCommand copy failed"))}function y(e,t){var e=p(e),r=!1;try{r=document.execCommand("copy")}catch(e){r=!1}return r?x(e):n(e,t)}function h(r){var e=p(r),t=!1;try{t=document.execCommand("cut")}catch(e){t=!1}return t?x(e):g(e).then(function(e){var t=r.nodeName;return"INPUT"===t||"TEXTAREA"===t?r.value="":r.hasAttribute("contenteditable")&&(r.innerHTML=""),e})}function g(e,t){var t=t||{},r=t.container||(l?document.body:null);return E(function(){var c;return u()?m(e).catch(function(){return l?n(e,r):T(new Error("Clipboard API failed and no fallback available"))}):l?n(e,r):o?(c=e,o?new Promise(function(t,r){var n,i=process.platform,e="win32"===i?(n="clip",[]):"darwin"===i?(n="pbcopy",[]):(n="xclip",["-selection","clipboard"]);try{var o=(0,require("child_process").spawn)(n,e,{stdio:["pipe","ignore","ignore"]}),a=!1;o.on("error",function(e){var o;a||(a=!0,"win32"!==i&&"darwin"!==i?(o=c,new Promise(function(t,r){try{var e=(0,require("child_process").spawn)("xsel",["--clipboard","--input"],{stdio:["pipe","ignore","ignore"]}),n=!1;e.on("error",function(e){n||(n=!0,r(new Error("No clipboard command available. Install xclip or xsel. "+e.message)))}),e.on("close",function(e){n||(n=!0,0===e?t(o):r(new Error("xsel exited with code: "+e)))}),e.stdin.write(o),e.stdin.end()}catch(e){r(new Error("Failed to spawn xsel: "+e.message))}}).then(t,r)):r(new Error("Clipboard command failed: "+n+" - "+e.message)))}),o.on("close",function(e){a||(a=!0,0===e?t(c):r(new Error("Clipboard command exited with code: "+e)))}),o.stdin.write(c),o.stdin.end()}catch(e){r(new Error("Failed to spawn clipboard process: "+e.message))}}):T(new Error("Not running in Node.js environment"))):T(new Error("No clipboard method available in this environment"))},t)}function e(e){return E(function(){return l&&"undefined"!=typeof navigator&&null!=navigator.clipboard&&"function"==typeof navigator.clipboard.readText?navigator.clipboard.readText():o?o?new Promise(function(t,r){var n,o=process.platform,e="win32"===o?(n="powershell",["-command","Get-Clipboard"]):"darwin"===o?(n="pbpaste",[]):(n="xclip",["-selection","clipboard","-o"]);try{var i=(0,require("child_process").spawn)(n,e,{stdio:["ignore","pipe","ignore"]}),a="",c=!1;i.stdout.on("data",function(e){a+=e.toString()}),i.on("error",function(e){c||(c=!0,"win32"!==o&&"darwin"!==o?new Promise(function(t,r){try{var e=(0,require("child_process").spawn)("xsel",["--clipboard","--output"],{stdio:["ignore","pipe","ignore"]}),n="",o=!1;e.stdout.on("data",function(e){n+=e.toString()}),e.on("error",function(e){o||(o=!0,r(new Error("No clipboard read command available. Install xclip or xsel. "+e.message)))}),e.on("close",function(e){o||(o=!0,0===e?t(n):r(new Error("xsel read exited with code: "+e)))})}catch(e){r(new Error("Failed to spawn xsel for read: "+e.message))}}).then(t,r):r(new Error("Clipboard read command failed: "+n+" - "+e.message)))}),i.on("close",function(e){c||(c=!0,0===e?t("win32"===o?a.replace(/\r?\n$/,""):a):r(new Error("Clipboard read command exited with code: "+e)))})}catch(e){r(new Error("Failed to spawn clipboard read process: "+e.message))}}):T(new Error("Not running in Node.js environment")):T(new Error("Clipboard read not supported in this environment"))},e||{})}function a(e,t){var r={},t=(r[t||e.type||"image/png"]=e,new ClipboardItem(r));return navigator.clipboard.write([t]).then(function(){return e})}function v(e,t){return((n=e)instanceof Blob?x(n):"undefined"!=typeof HTMLCanvasElement&&n instanceof HTMLCanvasElement?new Promise(function(t,r){try{n.toBlob(function(e){e?t(e):r(new Error("Canvas toBlob returned null"))},"image/png")}catch(e){r(new Error("Canvas toBlob failed: "+e.message))}}):"undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement?(e=n.src)?fetch(e).then(function(e){if(e.ok)return e.blob();throw new Error("Failed to fetch image: "+e.status)}).catch(function(e){return T(new Error("Failed to fetch image (CORS?): "+e.message))}):T(new Error("Image element has no src")):c(n)?fetch(n).then(function(e){if(e.ok)return e.blob();throw new Error("Failed to fetch image: "+e.status)}).catch(function(e){return T(new Error("Failed to fetch image URL (CORS?): "+e.message))}):T(new TypeError("Unsupported image source type"))).then(function(e){return E(function(){return a(e,e.type)},t)});var n}function w(e,t,r){var n=document.createElement("div"),o=(n.style.position="absolute",n.style.opacity="0",n.style.pointerEvents="none","rtl"===document.documentElement.getAttribute("dir")),o=(n.style[o?"right":"left"]="-9999px",window.pageYOffset||document.documentElement.scrollTop);n.style.top=o+"px",n.innerHTML=t;(r||document.body).appendChild(n);o=window.getSelection(),r=document.createRange(),r.selectNodeContents(n),o.removeAllRanges(),o.addRange(r),o=!1;try{o=document.execCommand("copy")}catch(e){o=!1}return n.remove(),f(),o?x({text:e,html:t}):T(new Error("execCommand copy failed for rich text"))}function b(e){var o=e.text,i=e.html,a=e.container||(l?document.body:null);return E(function(){var e,t,r,n;return d()?(e=o,t=i,r=new Blob([e],{type:"text/plain"}),n=new Blob([t],{type:"text/html"}),r=new ClipboardItem({"text/plain":r,"text/html":n}),navigator.clipboard.write([r]).then(function(){return{text:e,html:t}}).catch(function(){return w(o,i,a)})):w(o,i,a)},e)}function E(e,t){var o,i,n="number"==typeof(t=t)?{retries:t,retryDelay:100,timeout:0}:{retries:null!=(t=t||{}).retries?t.retries:2,retryDelay:null!=t.retryDelay?t.retryDelay:100,timeout:null!=t.timeout?t.timeout:0},a=0;return o=function r(){return e().catch(function(e){var t;return a++,n.retries<a?T(e):(t=Math.pow(2,a-1)*n.retryDelay,new Promise(function(e){setTimeout(e,t)}).then(r))})}(),!(i=n.timeout)||i<=0?o:new Promise(function(t,r){var n=setTimeout(function(){r(new Error("Operation timed out after "+i+"ms"))},i);o.then(function(e){clearTimeout(n),t(e)},function(e){clearTimeout(n),r(e)})})}function x(e){return Promise.resolve(e)}function T(e){return Promise.reject(e)}function C(e,t){e="data-nc-"+e;if(t.hasAttribute(e))return t.getAttribute(e)}function S(e,r,t,n){function o(e){var t=function(e,t){if(e.closest)return e.closest(t);for(var r,n,o,i=e;i&&1===i.nodeType;){if(n=t,o=void 0,(o=(r=i).matches||r.matchesSelector||r.msMatchesSelector||r.mozMatchesSelector||r.webkitMatchesSelector||r.oMatchesSelector)&&o.call(r,n))return i;i=i.parentNode}return null}(e.target,r);t&&n.call(e.delegateTarget=t,e)}return e.addEventListener(t,o,!1),{destroy:function(){e.removeEventListener(t,o,!1)}}}function A(e,t,r){if(c(e))return S(document.body,e,t,r);if(s(e))return e.addEventListener(t,r,!1),{destroy:function(){e.removeEventListener(t,r,!1)}};if(i=e,a=Object.prototype.toString.call(i),null!=i&&("[object NodeList]"===a||"[object HTMLCollection]"===a)&&"length"in i&&(0===i.length||s(i[0]))){for(var n=[],o=0;o<e.length;o++)!function(e){e.addEventListener(t,r,!1),n.push(function(){e.removeEventListener(t,r,!1)})}(e[o]);return{destroy:function(){for(var e=0;e<n.length;e++)n[e]()}}}var i,a;throw new TypeError("First argument must be a String selector, HTMLElement, or NodeList")}function L(e,n){if(!i(n))throw new TypeError("Callback must be a function");function t(e){var t=e.delegateTarget||e.currentTarget||e.target,r=function(e){var t={text:"",html:"",files:[]};if(e){try{t.text=e.getData("text/plain")||""}catch(e){}try{t.html=e.getData("text/html")||""}catch(e){}try{e.files&&0<e.files.length&&(t.files=Array.prototype.slice.call(e.files))}catch(e){}}return t}(e.clipboardData);r.originalEvent=e,r.trigger=t,n(r)}if(null==e)return document.addEventListener("paste",t,!1),{destroy:function(){document.removeEventListener("paste",t,!1)}};if(c(e))return S(document.body,e,"paste",t);if(s(e))return e.addEventListener("paste",t,!1),{destroy:function(){e.removeEventListener("paste",t,!1)}};throw new TypeError("Target must be a String selector, HTMLElement, or null")}function N(e,t){if(!(this instanceof N))return new N(e,t);r.call(this),this._destroyed=!1,this._listener=null,this.resolveOptions(t||{}),l&&e&&this.listenClick(e)}return r.prototype.on=function(e,t,r){return c(e)&&i(t)&&(this._events[e]||(this._events[e]=[])).push({fn:t,ctx:r,once:!1}),this},r.prototype.once=function(e,t,r){return c(e)&&i(t)&&(this._events[e]||(this._events[e]=[])).push({fn:t,ctx:r,once:!0}),this},r.prototype.off=function(e,t){if(c(e)){var r=this._events[e];if(r)if(t){for(var n=[],o=0;o<r.length;o++)r[o].fn!==t&&n.push(r[o]);n.length?this._events[e]=n:delete this._events[e]}else delete this._events[e]}return this},r.prototype.emit=function(e){var t=this._events[e];if(t&&0!==t.length){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);for(var o=t.slice(),i=[],a=0;a<o.length;a++)o[a].fn.apply(o[a].ctx,r),o[a].once&&i.push(o[a]);if(i.length){for(var c=[],l=0;l<t.length;l++)-1===i.indexOf(t[l])&&c.push(t[l]);c.length?this._events[e]=c:delete this._events[e]}}return this},r.prototype.removeAllListeners=function(){return this._events={},this},((N.prototype=Object.create(r.prototype)).constructor=N).prototype.resolveOptions=function(e){this.action=i(e.action)?e.action:this.defaultAction,this.target=i(e.target)?e.target:this.defaultTarget,this.text=i(e.text)?e.text:this.defaultText,this.container=s(e.container)?e.container:l?document.body:null,this.retries=null!=e.retries?e.retries:2,this.retryDelay=null!=e.retryDelay?e.retryDelay:100,this.timeout=null!=e.timeout?e.timeout:0},N.prototype.listenClick=function(e){var t=this;this._listener=A(e,"click",function(e){t.onClick(e)})},N.prototype.onClick=function(e){var t=e.delegateTarget||e.currentTarget,r=this.action(t)||"copy",e=this.target(t),n=this.text(t),o=this;if("copy"!==r&&"cut"!==r)o.emit("error",{action:r,trigger:t,error:new Error('Invalid action "'+r+'", use "copy" or "cut"'),clearSelection:f});else{var i,a,c="true"===C("html",t);if(n)l=g(n,{container:o.container,retries:o.retries,retryDelay:o.retryDelay,timeout:o.timeout});else{if(!e)return void o.emit("error",{action:r,trigger:t,error:new Error("No text or target specified"),clearSelection:f});if("cut"===r){if(e.hasAttribute("readonly")||e.hasAttribute("disabled"))return void o.emit("error",{action:r,trigger:t,error:new Error('Cannot cut from elements with "readonly" or "disabled" attributes'),clearSelection:f});l=h(e)}else if(c)var n=e.innerHTML,l=b({text:e.textContent||e.innerText||"",html:n,container:o.container,retries:o.retries,retryDelay:o.retryDelay,timeout:o.timeout}).then(function(e){return e.text});else{if(e.hasAttribute("disabled"))return void o.emit("error",{action:r,trigger:t,error:new Error('Cannot copy from elements with "disabled" attribute, use "readonly" instead'),clearSelection:f});i=e,c={container:o.container,retries:o.retries,retryDelay:o.retryDelay,timeout:o.timeout},a=(c=c||{}).container||document.body,l=E(function(){var e=p(i);return u()?m(e).catch(function(){return f(),y(i,a)}):y(i,a)},c)}}l.then(function(e){o.emit("success",{action:r,text:e,trigger:t,clearSelection:f})}).catch(function(e){o.emit("error",{action:r,trigger:t,error:e,clearSelection:f})})}},N.prototype.defaultAction=function(e){return C("action",e)||"copy"},N.prototype.defaultTarget=function(e){e=C("target",e);if(e)return document.querySelector(e)},N.prototype.defaultText=function(e){return C("text",e)},N.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this._listener&&(this._listener.destroy(),this._listener=null),this.removeAllListeners(),this.action=null,this.target=null,this.text=null,this.container=null)},N.copy=function(e,t){return c(e)?g(e,t):T(new TypeError("NowClipboard.copy() expects a string argument"))},N.cut=function(e){return l?s(e)?h(e):T(new TypeError("NowClipboard.cut() expects an HTMLElement argument")):T(new Error("NowClipboard.cut() is only available in browser environment"))},N.read=e,N.checkSupport=function(e){if(o)return!0;if(!l)return!1;if(u())return!0;for(var t=e||["copy","cut"],r=(c(t)&&(t=[t]),!0),n=0;n<t.length;n++)r=r&&function(e){if(!l)return!1;try{return!!document.queryCommandSupported&&document.queryCommandSupported(e)}catch(e){return!1}}(t[n]);return r},N.queryPermission=function(e){if("read"!==e&&"write"!==e)return T(new TypeError('queryPermission() expects "read" or "write"'));if(o)return x({state:"granted"});e="clipboard-"+e;if(!l||"undefined"==typeof navigator||!navigator.permissions||!i(navigator.permissions.query))return x({state:"prompt"});try{return navigator.permissions.query({name:e}).then(function(e){return{state:e.state}}).catch(function(){return{state:"prompt"}})}catch(e){return x({state:"prompt"})}},N.onPaste=function(e,t){if(l)return L(e,t);throw new Error("NowClipboard.onPaste() is only available in browser environment")},N.copyImage=function(e,t){return l?d()?v(e,t):T(new Error("ClipboardItem API not supported. Requires HTTPS and a modern browser")):T(new Error("NowClipboard.copyImage() is only available in browser environment"))},N.copyBlob=function(e,t,r){var n;return l?d()?e instanceof Blob?(n=t||e.type,E(function(){return a(e,n)},r)):T(new TypeError("NowClipboard.copyBlob() expects a Blob argument")):T(new Error("ClipboardItem API not supported. Requires HTTPS and a modern browser")):T(new Error("NowClipboard.copyBlob() is only available in browser environment"))},N.copyRich=function(e){return e&&c(e.text)&&c(e.html)?l?b(e):T(new Error("NowClipboard.copyRich() is only available in browser environment")):T(new TypeError("NowClipboard.copyRich() requires { text: string, html: string }"))},N});